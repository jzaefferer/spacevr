<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, Space!</title>
    <script src="http://code.jquery.com/pep/0.4.1/pep.min.js"></script>
    <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>
  </head>
  <body touch-action="none">
    <script>
      AFRAME.registerComponent('click-listener', {
        init: function () {
          this.velocity = 0;
          var that = this;
          document.body.addEventListener('pointerdown', function () {
            // velocity.z = 0.01;
            that.accelerate = true;
          });
          document.body.addEventListener('pointerup', function () {
            that.accelerate = false;
          });
        },
        tick: function (t, dt) {
          var camera = this.el.object3D.children[0].quaternion;
          if (this.accelerate) {
            this.velocity += 0.01;
          } else {
            this.velocity -= 0.01;
          }
          this.velocity = Math.min(1, this.velocity);
          this.velocity = Math.max(0, this.velocity);
          var delta = new THREE.Vector3(0, 0, -this.velocity);
          delta.applyQuaternion(camera);
          var position = this.el.getAttribute('position');
          this.el.setAttribute('position', {
            x: position.x + delta.x,
            y: position.y + delta.y,
            z: position.z + delta.z
          });
        }
      });
    </script>
    <a-scene>
      <a-sphere position="0 1.25 -1" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-box position="-1 0.5 1" rotation="0 45 0" width="1" height="1" depth="1" color="#4CC3D9">
        <a-animation attribute="rotation" repeat="indefinite" dur="5000" to="0 405 0"></a-animation>
      </a-box>
      <a-cylinder position="1 0.75 1" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <a-sky src="starmap_g4k.jpg"></a-sky>

      <a-light type="spot" color="#333" position="-20 0 0" look-at="a-box"></a-light>
      <a-light type="point" color="#AAA" position="0 5 0"></a-light>

      <a-entity click-listener position="0 2 5">
        <a-entity camera look-controls>
          <a-cursor color="#2E3A87">
        </a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
