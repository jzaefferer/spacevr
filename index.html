<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hello, Space!</title>
    <script src="http://code.jquery.com/pep/0.4.1/pep.min.js"></script>
    <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>
  </head>
  <body>
    <script>
      AFRAME.registerComponent('click-listener', {
        init: function () {
          this.velocity = new THREE.Vector3();
          var that = this;
          document.body.addEventListener('pointerdown', function () {
            // velocity.z = 0.01;
            that.accelerate = true;
          });
          document.body.addEventListener('pointerup', function () {
            that.accelerate = false;
          });
        },
        tick: function (t, dt) {
          var velocity = this.velocity;
          var rotation = this.el.object3D.children[0].rotation;
          // TODO accelerate in the direction of the camera
          if (this.accelerate) {
            velocity.z += 0.01;
            velocity.z = Math.min(1, velocity.z);
          } else {
            velocity.z -= 0.01;
            velocity.z = Math.max(0, velocity.z);
          }
          var position = this.el.getAttribute('position');
          this.el.setAttribute('position', {
            x: position.x + velocity.x,
            y: position.y + velocity.y,
            z: position.z + velocity.z
          });
        }
      });
    </script>
    <a-scene>
      <a-sphere position="0 1.25 -1" radius="1.25" color="#EF2D5E"></a-sphere>
      <a-box position="-1 0.5 1" rotation="0 45 0" width="1" height="1" depth="1" color="#4CC3D9">
        <a-animation attribute="rotation" repeat="indefinite" dur="5000" to="0 405 0"></a-animation>
      </a-box>
      <a-cylinder position="1 0.75 1" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
      <a-plane rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
      <!-- <a-sky src="starmap_g4k.jpg"></a-sky> -->

      <a-light type="spot" color="#333" position="-20 0 0" look-at="a-box"></a-light>
      <a-light type="point" color="#AAA" position="0 5 0"></a-light>

      <a-entity click-listener position="0 2 5">
        <!-- <a-animation attribute="position" repeat="indefinite" dur="5000" to="0 3 6"></a-animation> -->
        <a-entity camera look-controls>
          <a-cursor color="#2E3A87">
        </a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
